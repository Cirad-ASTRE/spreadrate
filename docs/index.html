<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate the spread-rate of epidemics • spreadrate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate the spread-rate of epidemics">
<meta property="og:description" content="Estimate the local velocity of propagation of an epidemic
        event, given dates and locations of observed cases. The method
        estimates the surface of first date of invasion by
        interpolation of the earliest observations in a neighbourhood
        and derives the local spread rate as the inverse slope of the
        surface. Quantify the estimation uncertainty by a Monte Carlo
        approach. Visualise and simulate the spatio-temporal progress
        of epidemics.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">spreadrate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="spreadrate" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#spreadrate" class="anchor"></a>spreadrate</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of spreadrate is to estimate the <strong>local velocity of propagation</strong> of an epidemic event, given dates and locations of observed cases.</p>
<p>The method estimates the surface of <strong>first date of invasion</strong> by interpolation of the earliest observations in a neighbourhood and derives the <strong>local spread rate</strong> as the inverse slope of the surface.</p>
<p>Furthermore, it helps to quantify the estimation uncertainty by a Monte Carlo approach. Visualise and simulate the spatio-temporal progress of epidemics.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>To install the latest version of spreadrate, copy and paste the following in a R session.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(<span class="st">"remotes"</span>)) {</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"remotes"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"INLA"</span>, <span class="dt">repos=</span><span class="st">"https://inla.r-inla-download.org/R/testing"</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"Cirad-ASTRE/mapMCDA"</span>)</a></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Suppose that we have recorded the GPS coordinates and observation dates for all the observed cases of some emerging disease in mainland France into a table like this one.</p>
<pre><code>#&gt; # A tibble: 50 x 3
#&gt;    date         Lon   Lat
#&gt;    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 2019-02-03  7.05  49.0
#&gt;  2 2019-02-03  7.27  48.8
#&gt;  3 2019-02-12  5.07  49.5
#&gt;  4 2019-02-15  5.79  48.3
#&gt;  5 2019-02-16  7.01  47.5
#&gt;  6 2019-02-18  3.90  50.2
#&gt;  7 2019-02-19  6.12  47.5
#&gt;  8 2019-02-20  5.25  48.1
#&gt;  9 2019-02-21  4.18  48.9
#&gt; 10 2019-02-24  3.17  50.1
#&gt; # … with 40 more rows</code></pre>
<p>Here is a visual representation of these observed cases.</p>
<p><img src="reference/figures/README-map-obs-1.png" width="100%"></p>
<p>First let <code>spreadrate</code> interpret the observational data appropriately with the function <code><a href="reference/sr_obs.html">sr_obs()</a></code>. You need to specify the name of the temporal variable. <em>Lon</em> and <em>Lat</em> are recognised automatically.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(spreadrate)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">cases_sr &lt;-<span class="st"> </span><span class="kw"><a href="reference/sr_obs.html">sr_obs</a></span>(cases, <span class="st">"date"</span>)</a></code></pre></div>
<p>However, spread-rate calculations require projected (rather than geographic) coordinates. An appropriate projection for mainland France is EPSG:2154. See <a href="https://epsg.io/" class="uri">https://epsg.io/</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">cases_sr &lt;-<span class="st"> </span><span class="kw">st_transform</span>(cases_sr, <span class="dt">crs =</span> <span class="dv">2154</span>)</a></code></pre></div>
<p>Everything is now set to perform a default estimation of spread-rate.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">sr_est &lt;-<span class="st"> </span><span class="kw"><a href="reference/sr.html">sr</a></span>(cases_sr)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; Warning: </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; Grid searches over lambda (nugget and sill variances) with  minima at the endpoints: </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;   (GCV) Generalized Cross-Validation </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;    minimum at  right endpoint  lambda  =  1.377511e-05 (eff. df= 41.79999 </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; )</span></a></code></pre></div>
<p>Done! Here is a quick plot of the estimated local spread-rate. The estimated velocity is practically constant, between 9 and 11 km / day.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(sr_est, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">hcl.colors</a></span>(<span class="dv">12</span>))</a></code></pre></div>
<p><img src="reference/figures/README-quick-plot-1.png" width="100%"></p>
<p>This is consistent with the value of 10^{4} m/day used for simulating the data.</p>
<p>We can also retrieve the estimated surface of first-date of invasion:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attr">attr</a></span>(sr_est, <span class="st">"fdoi"</span>), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">hcl.colors</a></span>(<span class="dv">12</span>))</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/Cirad-ASTRE/spreadrate/issues">https://​github.com/​Cirad-ASTRE/​spreadrate/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Facundo Muñoz <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-5061-4241" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
